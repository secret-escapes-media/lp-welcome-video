<div class="modal modal--youtube is-closed" data-modal-id="{{modal.id}}" data-youtube-id="{{modal.youtube-id}}">
  <div class="js-close-modal modal__close"></div>
  <div class="js-modal-video">
    <div class="video__wrap">
      <div id="ytPlayer"></div>
    </div>
  </div>
</div>
<script>
  var tag = document.createElement('script');

  tag.src = "https://www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  var ytPlayer;
  function onYouTubeIframeAPIReady() {
    ytPlayer = new YT.Player('ytPlayer', {
      height: '100%',
      width: '100%',
      videoId: '{{modal.youtube-id}}',
      playerVars: {rel: 0},
      events: {
        'onStateChange': onPlayerStateChange
      }
    });
  }

  var done = false;
    function onPlayerStateChange(event) {
      if (event.data == YT.PlayerState.ENDED && !done) {
        $('body').removeClass('disable-scroll');
        // close modal
        $('.modal__bg.is-open').hide();
        // close modal and active modal content
        $('modal__bg').removeClass('is-open').addClass('is-closed');
        $('.modal.is-open').removeClass('is-open').addClass('is-closed');
        // kill everything inside of video if its there
        ytPlayer.pauseVideo();
        done = true;
      }
    }

  function stopVideo() {
    ytPlayer.stopVideo();
  }
</script>